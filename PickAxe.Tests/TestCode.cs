//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.34014
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using HtmlAgilityPack;
using Pickaxe.Runtime;
using System;
using System.Collections.Generic;
using System.Linq;



public class Code : RuntimeBase
{

    private Scope_c71868587cb74bdbb7ca9a0d12a245a2 _Scope_c71868587cb74bdbb7ca9a0d12a245a2;

    private Scope_30f7bd9ee91b4c22b419c8121b9f2fc4 _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4;

    public Code(string[] args) :
        base(args)
    {
        _Scope_c71868587cb74bdbb7ca9a0d12a245a2 = new Scope_c71868587cb74bdbb7ca9a0d12a245a2();
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4 = new Scope_30f7bd9ee91b4c22b419c8121b9f2fc4();
        TotalOperations = (TotalOperations + 2);
    }

    public void Run()
    {
        InitProxies();
        Block_ddf28751be2749cbbceeeb07ed8b6eb2();
        Step_20395b9cbca94e7dbafb9ed7ec59a44f();
    }

    public void Block_ddf28751be2749cbbceeeb07ed8b6eb2()
    {
        Step_d68e9011bc4a42159295cce9bc46b3e6();
        Step_837b20e6bdce4dc187811c4c8b3e99c9();
    }

    private void Init_prices()
    {
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.ConnectionString = "Server=sandbagger;Database=scrape;Trusted_Connection=True;";
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.Table = "dbo.prices";
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.FieldNames = new[] { "rentalId", "season" };
    }

    public void Step_d68e9011bc4a42159295cce9bc46b3e6()
    {
        Init_prices();
        OnProgress();
    }

    private Table<ResultRow> Select_721f8cfb01af4c35952ecf41924feafa()
    {
        Call(14);
        RuntimeTable<ResultRow> result = new RuntimeTable<ResultRow>();
        ResultRow resultRow = new ResultRow(2);
        resultRow[0] = 1;
        resultRow[1] = "two";
        result.Add(resultRow);
        return result;
    }

    private void Insert_36bae969c7684c4fb7cb2055eb3530bc()
    {
        Call(13);
        Table<ResultRow> resultRows = Select_721f8cfb01af4c35952ecf41924feafa();
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.BeforeInsert(false);
        _Scope_c71868587cb74bdbb7ca9a0d12a245a2.g_identity = _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.RowCount;
        IEnumerator<ResultRow> x = resultRows.GetEnumerator();
        for (
        ; x.MoveNext();
        )
        {
            _Scope_c71868587cb74bdbb7ca9a0d12a245a2.g_identity = (_Scope_c71868587cb74bdbb7ca9a0d12a245a2.g_identity + 1);
            ResultRow row = x.Current;
            prices tableRow = new prices();
            tableRow.rentalId = Convert.ToInt32(row[0]);
            tableRow.season = Convert.ToString(row[1]);
            _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.Add(tableRow);
        }
        _Scope_30f7bd9ee91b4c22b419c8121b9f2fc4.prices.AfterInsert();
    }

    public void Step_837b20e6bdce4dc187811c4c8b3e99c9()
    {
        Insert_36bae969c7684c4fb7cb2055eb3530bc();
        OnProgress();
    }

    public void Step_20395b9cbca94e7dbafb9ed7ec59a44f()
    {
        OnProgress(new ProgressArgs(TotalOperations, TotalOperations));
    }

    private class Scope_c71868587cb74bdbb7ca9a0d12a245a2
    {

        public int g_identity;

        public Scope_c71868587cb74bdbb7ca9a0d12a245a2()
        {
        }
    }

    private class Scope_30f7bd9ee91b4c22b419c8121b9f2fc4
    {

        public MsSqlTable<prices> prices;

        public Scope_30f7bd9ee91b4c22b419c8121b9f2fc4()
        {
            prices = new MsSqlTable<prices>();
        }
    }

    private class prices : IRow
    {

        public int rentalId;

        public string season;

    }
}
