//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.34014
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Pickaxe.Runtime;
using Pickaxe.Runtime.Dom;
using System;
using System.Collections.Generic;
using System.Linq;



public class Code : RuntimeBase
{

    private Scope_cba7f41d8c164b8b943a63ebed345293 _Scope_cba7f41d8c164b8b943a63ebed345293;

    private Scope_55a3ba0931744a25ac1d7168587b7584 _Scope_55a3ba0931744a25ac1d7168587b7584;

    public Code(string[] args) :
        base(args)
    {
        _Scope_cba7f41d8c164b8b943a63ebed345293 = new Scope_cba7f41d8c164b8b943a63ebed345293();
        _Scope_55a3ba0931744a25ac1d7168587b7584 = new Scope_55a3ba0931744a25ac1d7168587b7584();
        TotalOperations = (TotalOperations + 1);
    }

    public void Run()
    {
        InitProxies();
        Block_8111cfd16b564986b04619d8a42ae9cc();
        Step_27f74cbf6dda43ce93771ad6573c773b();
    }

    public void Block_8111cfd16b564986b04619d8a42ae9cc()
    {
        Step_a423c61d04ab42fe985152bee282ddcd();
    }

    private CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> From_39e73a91db60410aae7d5f7291eb4e7f()
    {
        Call(6);
        IEnumerable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> join = Fetch_eaf38dec73634f528a97bb64821df7bd();
        CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> newTable = new CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9>();
        newTable.SetRows(join.ToList());
        return newTable;
    }

    private RuntimeTable<DownloadPage> Download_c63c130645014f7db926e59691af23cd()
    {
        Call(6);
        return new SelectDownloadTable(Pickaxe.Runtime.LazyDownloadArgs.CreateWebRequestArgs(this, 6, 1, "http://mock.com"));
    }

    private IEnumerable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> Fetch_eaf38dec73634f528a97bb64821df7bd()
    {
        RuntimeTable<DownloadPage> table = Download_c63c130645014f7db926e59691af23cd();
        return table.Select(o =>
        {
            return Copy_211e6dd1192a4470b6418d11e8da49f0(o);
        });
    }

    private anon_c29202ffe8814fbb8b7b82a9c0db57c9 Copy_211e6dd1192a4470b6418d11e8da49f0(DownloadPage o)
    {
        anon_c29202ffe8814fbb8b7b82a9c0db57c9 t = new anon_c29202ffe8814fbb8b7b82a9c0db57c9();
        t.DownloadPage = o;
        return t;
    }

    private Table<ResultRow> Select_fcbedd7e17c141cead480a315cef90b0()
    {
        Call(4);
        RuntimeTable<ResultRow> result = new RuntimeTable<ResultRow>();
        result.AddColumn("(No column name)");
        result.AddColumn("(No column name)");
        CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> fromTable = From_39e73a91db60410aae7d5f7291eb4e7f();
        fromTable = Where_09ffc33fb1394ad4b75de62ac8a100bb(fromTable);
        IEnumerator<anon_c29202ffe8814fbb8b7b82a9c0db57c9> x = fromTable.GetEnumerator();
        for (
        ; x.MoveNext();
        )
        {
            anon_c29202ffe8814fbb8b7b82a9c0db57c9 row = x.Current;
            IEnumerator<HtmlElement> y = row.DownloadPage.nodes.GetEnumerator();
            for (
            ; y.MoveNext();
            )
            {
                HtmlElement node = y.Current;
                ResultRow resultRow = new ResultRow(2);
                resultRow[0] = Case_d9e1e6382b864ad798e3818989650930(row, node);
                resultRow[1] = node.Pick("li:first-child").TakeText().Match("[\\d\\.]+");
                result.Add(resultRow);
            }
            row.DownloadPage.Clear();
        }
        OnSelect(result);
        return result;
    }

    private object Case_53ccee6c1a6f453ba916e9ec37d5bde3(anon_c29202ffe8814fbb8b7b82a9c0db57c9 row, HtmlElement node)
    {
        Call(4);
        object var = node.Pick("li:first-child").TakeText().Match("[\\d\\.]+");
        if (((var != null)
                    && var.Equals(6566)))
        {
            return 2;
        }
        return null;
    }

    private object Case_d9e1e6382b864ad798e3818989650930(anon_c29202ffe8814fbb8b7b82a9c0db57c9 row, HtmlElement node)
    {
        Call(4);
        object var = node.Pick("li:first-child").TakeText().Match("[\\d\\.]+");
        if (((var != null)
                    && var.Equals(6566)))
        {
            return 2;
        }
        return null;
    }

    private CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> Where_09ffc33fb1394ad4b75de62ac8a100bb(CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> table)
    {
        Call(7);
        CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9> newTable = new CodeTable<anon_c29202ffe8814fbb8b7b82a9c0db57c9>();
        IList<anon_c29202ffe8814fbb8b7b82a9c0db57c9> rows = table.Where(row =>
        {
            return row.DownloadPage.CssWhere(ref row.DownloadPage, "#match-tests");
        }).ToList();
        newTable.SetRows(rows);
        return newTable;
    }

    public void Step_a423c61d04ab42fe985152bee282ddcd()
    {
        Select_fcbedd7e17c141cead480a315cef90b0();
        OnProgress();
    }

    public void Step_27f74cbf6dda43ce93771ad6573c773b()
    {
        OnProgress(new ProgressArgs(TotalOperations, TotalOperations));
    }

    private class Scope_cba7f41d8c164b8b943a63ebed345293
    {

        public int g_identity;

        public Scope_cba7f41d8c164b8b943a63ebed345293()
        {
        }
    }

    private class Scope_55a3ba0931744a25ac1d7168587b7584
    {

        public Scope_55a3ba0931744a25ac1d7168587b7584()
        {
        }
    }

    private class anon_c29202ffe8814fbb8b7b82a9c0db57c9 : IRow
    {

        public DownloadPage DownloadPage;
    }
}
